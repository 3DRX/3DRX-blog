---
import { CollectionEntry, getCollection } from "astro:content";
import PhotographyPost from "../../layouts/PhotographyPost.astro";
import BlogEnd from "../../components/BlogEnd.astro";

export async function getStaticPaths() {
  const posts = (await getCollection("photography")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
  );
  const numPosts = posts.length;
  return posts.map((post, i) => {
    let prevPost = null;
    let nextPost = null;
    if (i + 1 === numPosts) {
      prevPost = null;
    } else {
      prevPost = {
        slug: posts[i + 1].slug,
        title: posts[i + 1].data.title,
      };
    }
    if (i === 0) {
      nextPost = null;
    } else {
      nextPost = {
        slug: posts[i - 1].slug,
        title: posts[i - 1].data.title,
      };
    }
    return {
      params: { slug: post.slug },
      props: {
        ...post,
        prevPost: prevPost,
        nextPost: nextPost,
      },
    };
  });
}

const post = Astro.props;
const { Content } = await post.render();
---

<PhotographyPost {...post.data}>
  <style>
    img {
      max-width: 100%;
      height: auto;
      filter: drop-shadow(#000 0px 0px 30px);
      padding-top: 4rem;
      padding-bottom: 4rem;
    }
  </style>
  <Content />
  <BlogEnd prev={post.prevPost} next={post.nextPost} />
</PhotographyPost>
